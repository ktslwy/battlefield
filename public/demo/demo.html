<!DOCTYPE html>
<html>
<head>
<script src="http://code.createjs.com/easeljs-0.7.1.min.js"></script>
<script src="http://yui.yahooapis.com/3.14.1/build/yui/yui-min.js"></script>
<!--
<script type="text/javascript" src="/js/lib/createjs/events/Event.js"></script>
<script type="text/javascript" src="/js/lib/createjs/events/EventDispatcher.js"></script>
<script type="text/javascript" src="/js/lib/createjs/utils/IndexOf.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/utils/UID.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/utils/Ticker.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/geom/Matrix2D.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/geom/Point.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/geom/Rectangle.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Shadow.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/SpriteSheet.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Graphics.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/DisplayObject.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Container.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Stage.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Bitmap.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Sprite.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/BitmapAnimation.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/BitmapText.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Shape.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/Text.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/display/DOMElement.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/events/MouseEvent.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/filters/Filter.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/ui/ButtonHelper.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/ui/Touch.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/utils/SpriteSheetUtils.js"></script>
<script type="text/javascript" src="/js/lib/easeljs/utils/SpriteSheetBuilder.js"></script>
-->
<script src="/js/spritesheets.js"></script>
</head>
<body style="margin:0">

<canvas id="battlefield" width="960" height="400" style="background-color: green"></canvas>

<script>
YUI().use('node', 'battlefield-spritesheets', function(Y){

    var spriteSheets    = Y.Battlefield.SpriteSheets,
        lightInfantrySS = spriteSheets.getSpriteSheet('light-infantry'),
        heavyInfantrySS = spriteSheets.getSpriteSheet('heavy-infantry'),
        // stage           = new createjs.Stage(Y.one('#battlefield').getDOMNode()),
        stage           = new createjs.Stage(document.getElementById('battlefield')),
        lightInfantry   = new createjs.Sprite(lightInfantrySS, 'stand'),
        heavyInfantry   = new createjs.Sprite(heavyInfantrySS, 'stand');

    createjs.Ticker.setFPS(12);
    createjs.Ticker.addEventListener("tick", stage);
    
    lightInfantry.x = 0;
    lightInfantry.y = 0;

    stage.addChild(lightInfantry);

    /////////////////////////////////

    function chainAnimation(sprite, animations, options) {
        var animation = animations.splice(0, 1),
            listener;

        options = options || {};

        listener = sprite.on('animationend', function(){
            sprite.off('animationend', listener);
            if (animations.length > 0) {
                chainAnimation(sprite, animations, options);
            } else {
                if (options.stopAtLast) {
                    sprite.stop();
                }
                if (typeof options.callback === 'function') {
                    options.callback();
                }
            }
        });

        sprite.gotoAndPlay(animation);
    }

    chainAnimation(lightInfantry, ['stand', 'walk', 'walk', 'walk', 'fire', 'stand'], {
        stopAtLast : true
    });
});
</script>

</body>
</html>